<Window x:Class="LoneEftDmaRadar.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LoneEftDmaRadar"
        xmlns:vm="clr-namespace:LoneEftDmaRadar"
        xmlns:tabs="clr-namespace:LoneEftDmaRadar.UI.Radar.Views"
        xmlns:hotkeys="clr-namespace:LoneEftDmaRadar.UI.Hotkeys"
        xmlns:controls="clr-namespace:LoneEftDmaRadar.UI.Controls"
        xmlns:behaviors="clr-namespace:LoneEftDmaRadar.UI.Behaviors"
        mc:Ignorable="d"
        Title="Twilight PVE Radar"
        Width="1280" Height="720"
        MinWidth="800" MinHeight="600"
        Icon="/lone-icon.ico">

    <d:Window.DataContext>
        <d:DesignInstance Type="{x:Type vm:MainWindowViewModel}"
                          IsDesignTimeCreatable="False"/>
    </d:Window.DataContext>

    <Grid x:Name="MainGrid">
        <!-- Layer 0: Radar (fills entire window) -->
        <tabs:RadarTab x:Name="Radar" Panel.ZIndex="0"/>

        <!-- Layer 1: Panel Canvas (floating panels) -->
        <Canvas x:Name="PanelCanvas" Panel.ZIndex="1">

            <!-- Settings Panel -->
            <controls:DraggablePanel
                x:Name="SettingsPanel"
                Title="âš™ Settings"
                Visibility="{Binding PanelManager.SettingsPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.SettingsPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.SettingsPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.SettingsPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.SettingsPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:SettingsTab/>
            </controls:DraggablePanel>

            <!-- ESP Fuser Panel -->
            <controls:DraggablePanel
                x:Name="EspPanel"
                Title="ðŸ‘ ESP Fuser"
                Visibility="{Binding PanelManager.EspPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.EspPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.EspPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.EspPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.EspPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:EspSettingsTab/>
            </controls:DraggablePanel>

            <!-- Loot Filters Panel -->
            <controls:DraggablePanel
                x:Name="LootFiltersPanel"
                Title="ðŸŽ¯ Loot Filters"
                Visibility="{Binding PanelManager.LootFiltersPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.LootFiltersPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.LootFiltersPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.LootFiltersPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.LootFiltersPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:LootFiltersTab/>
            </controls:DraggablePanel>

            <!-- Static Containers Panel -->
            <controls:DraggablePanel
                x:Name="ContainersPanel"
                Title="ðŸ“¦ Containers"
                Visibility="{Binding PanelManager.ContainersPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.ContainersPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.ContainersPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.ContainersPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.ContainersPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:StaticContainersTab/>
            </controls:DraggablePanel>

            <!-- Loot List Panel -->
            <controls:DraggablePanel
                x:Name="LootListPanel"
                Title="ðŸ“‹ Loot List"
                Visibility="{Binding PanelManager.LootListPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.LootListPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.LootListPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.LootListPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.LootListPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:LootListTab/>
            </controls:DraggablePanel>

            <!-- Active Quests Panel -->
            <controls:DraggablePanel
                x:Name="QuestsPanel"
                Title="ðŸ“ Active Quests"
                Visibility="{Binding PanelManager.QuestsPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.QuestsPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.QuestsPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.QuestsPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.QuestsPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:ActiveQuestsTab/>
            </controls:DraggablePanel>

            <!-- Hideout Panel -->
            <controls:DraggablePanel
                x:Name="HideoutPanel"
                Title="ðŸ  Hideout"
                Visibility="{Binding PanelManager.HideoutPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.HideoutPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.HideoutPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.HideoutPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.HideoutPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:HideoutTab/>
            </controls:DraggablePanel>

            <!-- Hotkeys Panel -->
            <controls:DraggablePanel
                x:Name="HotkeysPanel"
                Title="âŒ¨ Hotkeys"
                Visibility="{Binding PanelManager.HotkeysPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.HotkeysPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.HotkeysPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.HotkeysPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.HotkeysPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <hotkeys:HotkeyManagerTab/>
            </controls:DraggablePanel>

            <!-- Device Aimbot Panel -->
            <controls:DraggablePanel
                x:Name="AimbotPanel"
                Title="ðŸŽ¯ Device Aimbot"
                Visibility="{Binding PanelManager.AimbotPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.AimbotPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.AimbotPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.AimbotPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.AimbotPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:DeviceAimbotTab/>
            </controls:DraggablePanel>

            <!-- MemWrites Panel -->
            <controls:DraggablePanel
                x:Name="MemWritesPanel"
                Title="ðŸ’¾ MemWrites"
                Visibility="{Binding PanelManager.MemWritesPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.MemWritesPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.MemWritesPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.MemWritesPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.MemWritesPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:MemWritesTab/>
            </controls:DraggablePanel>

            <!-- Web Radar Panel -->
            <controls:DraggablePanel
                x:Name="WebRadarPanel"
                Title="ðŸŒ Web Radar"
                Visibility="{Binding PanelManager.WebRadarPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.WebRadarPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.WebRadarPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.WebRadarPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.WebRadarPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:WebRadarTab/>
            </controls:DraggablePanel>

            <!-- Visibility Panel -->
            <controls:DraggablePanel
                x:Name="VisibilityPanel"
                Title="LOS Settings"
                Visibility="{Binding PanelManager.VisibilityPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.VisibilityPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.VisibilityPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.VisibilityPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.VisibilityPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:VisibilityTab/>
            </controls:DraggablePanel>

            <!-- Debug Panel -->
            <controls:DraggablePanel
                x:Name="DebugPanel"
                Title="ðŸ”§ Debug"
                Visibility="{Binding PanelManager.DebugPanel.IsOpen, Converter={StaticResource BoolToVis}}"
                Canvas.Left="{Binding PanelManager.DebugPanel.X, Mode=TwoWay}"
                Canvas.Top="{Binding PanelManager.DebugPanel.Y, Mode=TwoWay}"
                Width="{Binding PanelManager.DebugPanel.Width, Mode=TwoWay}"
                Height="{Binding PanelManager.DebugPanel.Height, Mode=TwoWay}"
                CloseRequested="Panel_CloseRequested">
                <tabs:DebugTab/>
            </controls:DraggablePanel>

        </Canvas>

        <!-- Layer 2: Sidebar (auto-collapses) -->
        <controls:Sidebar x:Name="Sidebar"
                          Panel.ZIndex="2"
                          HorizontalAlignment="Left"
                          VerticalAlignment="Stretch"
                          DataContext="{Binding PanelManager}"/>
    </Grid>
</Window>
